var mahalanobis = require("./build/mahalanobis.js"),
    old = require("mahalanobis-old"),
    exec = require("child_process").exec;

var numFeatures = 1 + Math.random() * 5,
    numObservations = numFeatures + 1 + (Math.random() * 20);

var data = [];

for (var i = 0; i < numObservations; i++) {

  var row = [];

  for (var j = 0; j < numFeatures; j++) {
    row.push(Math.round(Math.random() * 20));
  }

  data.push(row);
}

console.log(data);

// Matches
//data = [[7,6,0],[5,0,3],[3,3,0],[5,2,3],[1,9,6],[7,1,1],[5,4,7],[2,8,0],[2,6,8],[3,1,6]];

var updated = mahalanobis(data);
var prev = old(data);
exec("python old/check.py \"" + JSON.stringify(data) + "\"", function(err, stdout){
  var py = JSON.parse(stdout);

  updated.forEach(function(a, i){
    var diff = Math.max(Math.abs(updated[i] - prev[i]),Math.abs(updated[i] - py[i]),Math.abs(py[i] - prev[i]));
    console.log(diff);
  });

});
